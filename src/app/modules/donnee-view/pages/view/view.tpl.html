<div class="bn-view-page">
  <div class="bn-entity-page-title">
    <h1>Consultation des données</h1>
  </div>

  <div>
    <div class="search-filters-panel">
      <form [formGroup]="searchForm">
        <div class="search-filters-form">
          <div>
            <!-- ID -->
            <mat-form-field>
              <input
                #input
                matInput
                [formControl]="searchForm.controls['id']"
                placeholder="ID"
                id="input-id"
                name="id"
                type="text"
              />
            </mat-form-field>

            <!-- OBSERVATEURS -->
            <mat-form-field>
              <mat-select
                placeholder="Observateurs"
                id="input-observateurs"
                name="observateurs"
                [formControl]="searchForm.controls['observateurs']"
                multiple
              >
                <mat-option
                  *ngFor="let observateur of observateurs"
                  [value]="observateur.id"
                >
                  {{ observateur.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- DATES -->
            <mat-form-field>
              <input
                matInput
                maxlength="5"
                [matDatepicker]="picker"
                placeholder="Date de début"
                id="input-from-date"
                name="from-date"
                [formControl]="searchForm.controls['fromDate']"
              />
              <mat-datepicker-toggle
                matSuffix
                [for]="picker"
              ></mat-datepicker-toggle>
              <mat-datepicker #picker></mat-datepicker>
            </mat-form-field>

            <mat-form-field>
              <input
                matInput
                maxlength="5"
                [matDatepicker]="pickerToDate"
                placeholder="Date de fin"
                id="input-to-date"
                name="to-date"
                [formControl]="searchForm.controls['toDate']"
              />
              <mat-datepicker-toggle
                matSuffix
                [for]="pickerToDate"
              ></mat-datepicker-toggle>
              <mat-datepicker #pickerToDate></mat-datepicker>
            </mat-form-field>

            <!-- HEURE -->
            <input-time
              [control]="searchForm.controls['heure']"
              id="heure"
              label="Heure"
            ></input-time>

            <!-- DUREE -->
            <input-time
              [control]="searchForm.controls['duree']"
              id="duree"
              label="Durée"
            ></input-time>
          </div>

          <div>
            <!-- DEPARTEMENT / COMMUNE / LIEUDIT -->
            <input-lieudit
              formGroupName="lieuditGroup"
              [controlGroup]="searchForm.controls['lieuditGroup']"
              [departements]="departements$"
              [communes]="communes$"
              [lieuxdits]="lieuxdits$"
              [hideCoordinates]="true"
            >
            </input-lieudit>

            <!-- TEMPERATURE -->
            <input-temperature
              [control]="searchForm.controls['temperature']"
            ></input-temperature>

            <!-- METEO -->
            <mat-form-field>
              <mat-select
                placeholder="Météos"
                id="input-meteos"
                name="meteos"
                [formControl]="searchForm.controls['meteos']"
                multiple
              >
                <mat-option *ngFor="let meteo of meteos" [value]="meteo.id">
                  {{ meteo.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- OBSERVATEURS ASSOCIES -->
            <mat-form-field>
              <mat-select
                placeholder="Observateurs associés"
                id="input-associes"
                name="associes"
                [formControl]="searchForm.controls['associes']"
                multiple
              >
                <mat-option
                  *ngFor="let associe of observateurs"
                  [value]="associe.id"
                >
                  {{ associe.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div>
            <!-- CLASSE / ESPECE -->
            <input-espece
              formGroupName="especeGroup"
              [controlGroup]="searchForm.controls['especeGroup']"
              [classes]="classes$"
              [especes]="especes$"
            ></input-espece>

            <!-- ESTIMATION NOMBRE / NOMBRE -->
            <input-nombre
              [controlGroup]="searchForm.controls['nombreGroup']"
              [estimationsNombre]="estimationsNombre"
              formGroupName="nombreGroup"
            >
            </input-nombre>

            <!-- SEXE -->
            <mat-form-field>
              <mat-select
                placeholder="Sexes"
                id="input-sexes"
                name="sexes"
                [formControl]="searchForm.controls['sexes']"
                multiple
              >
                <mat-option *ngFor="let sexe of sexes" [value]="sexe.id">
                  {{ sexe.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- AGE  -->
            <mat-form-field>
              <mat-select
                placeholder="Ages"
                id="input-ages"
                name="ages"
                [formControl]="searchForm.controls['ages']"
                multiple
              >
                <mat-option *ngFor="let age of ages" [value]="age.id">
                  {{ age.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <div>
            <!-- ESTIMATION DISTANCE / DISTANCE -->
            <input-distance
              [controlGroup]="searchForm.controls['distanceGroup']"
              [estimationsDistance]="estimationsDistance"
              formGroupName="distanceGroup"
            >
            </input-distance>

            <!-- REGROUPEMENT -->
            <input-regroupement
              [control]="searchForm.controls['regroupement']"
              [hideButton]="true"
            ></input-regroupement>

            <!-- COMPORTEMENT -->
            <!-- METEOS -->
            <mat-form-field>
              <mat-select
                placeholder="Comportements"
                id="input-comportements"
                name="comportements"
                [formControl]="searchForm.controls['comportements']"
                multiple
              >
                <mat-option
                  *ngFor="let comportement of comportements"
                  [value]="comportement.id"
                >
                  {{ comportement.code }} - {{ comportement.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- MILIEU -->
            <mat-form-field>
              <mat-select
                placeholder="Milieux"
                id="input-milieux"
                name="milieux"
                [formControl]="searchForm.controls['milieux']"
                multiple
              >
                <mat-option *ngFor="let milieu of milieux" [value]="milieu.id">
                  {{ milieu.code }} - {{ milieu.libelle }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <!-- COMMENTAIRES -->
            <mat-form-field>
              <input
                matInput
                type="text"
                placeholder="Commentaires"
                id="input-commentaire"
                name="input-commentaire"
                [formControl]="searchForm.controls['commentaire']"
              />
            </mat-form-field>
          </div>
        </div>
        <button
          mat-raised-button
          color="primary"
          (click)="onSearchButtonClicked()"
          [disabled]="displayWaitPanel"
        >
          Lancer la recherche
        </button>

        <!-- Retourner un fichier excel -->
        <mat-checkbox
          id="input-excel"
          name="input-excel"
          [formControl]="searchForm.controls['excelMode']"
          >Exporter les résultats dans un fichier Excel</mat-checkbox
        >
      </form>
    </div>

    <table-donnees
      *ngIf="!displayWaitPanel"
      [donneesToDisplay]="donneesToDisplay"
    ></table-donnees>

    <div *ngIf="displayWaitPanel" style="text-align: center">
      <img
        src="../../../../../assets/img/green-bird.svg"
        alt="Oiseaux"
        height="200px"
      />
      <div>Les données arrivent...</div>
    </div>
  </div>
</div>
