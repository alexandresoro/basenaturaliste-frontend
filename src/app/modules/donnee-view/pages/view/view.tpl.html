<div class="lco-view-page">
  <h1>Vue des données (en cours de dévelopement)</h1>

  <div>
    <div>
      <div>
        <button
          mat-raised-button
          color="primary"
          (click)="onOpenQueryButtonClicked()"
        >
          Ouvrir une requête existante
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="onNewQueryButtonClicked()"
        >
          Nouvelle requête
        </button>
      </div>
      <div>
        <mat-tree
          [dataSource]="treeData"
          [treeControl]="treeControl"
          class="tree"
        >
          <!-- This is the tree node template for leaf nodes -->
          <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
            <li class="mat-tree-node">
              <mat-checkbox
                [checked]="isTreeCheckboxSelected(node.key)"
                (change)="onTreeCheckboxClicked($event.checked, node.key)"
                >{{ columns[node.key].displayName }}</mat-checkbox
              >
            </li>
          </mat-tree-node>
          <!-- This is the tree node template for expandable nodes -->
          <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
            <li>
              <div class="mat-tree-node">
                <button
                  mat-icon-button
                  matTreeNodeToggle
                  [attr.aria-label]="'toggle ' + node.key"
                >
                  <mat-icon class="mat-icon-rtl-mirror">
                    {{
                      treeControl.isExpanded(node)
                        ? "expand_more"
                        : "chevron_right"
                    }}
                  </mat-icon>
                </button>
                {{ node.key }}
              </div>
              <ul [class.tree-invisible]="!treeControl.isExpanded(node)">
                <ng-container matTreeNodeOutlet></ng-container>
              </ul>
            </li>
          </mat-nested-tree-node>
        </mat-tree>
      </div>
    </div>

    <div>
      <div>Query Name</div>

      <div>
        <div>
          <button
            mat-raised-button
            color="primary"
            (click)="onAddSelectButtonClicked()"
          >
            Afficher
          </button>
        </div>

        <div>
          Colonnes à afficher:
          <table mat-table [dataSource]="selectTableDataSource">
            <
            <!-- Up/down buttons -->
            <ng-container matColumnDef="updown">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let row">
                <button
                  mat-raised-button
                  color="primary"
                  (click)="onUpSelectRowButtonClicked(row)"
                >
                  Monter
                </button>
                <button
                  mat-raised-button
                  color="primary"
                  (click)="onDownSelectRowButtonClicked(row)"
                >
                  Descendre
                </button>
              </td>
            </ng-container>

            <!-- Fonction -->
            <ng-container matColumnDef="function">
              <th mat-header-cell *matHeaderCellDef>Fonction</th>
              <td mat-cell *matCellDef="let row"></td>
            </ng-container>

            <!-- Colonne -->
            <ng-container matColumnDef="column">
              <th mat-header-cell *matHeaderCellDef>Colonne</th>
              <td mat-cell *matCellDef="let row">
                {{ columns[row.key].displayName }}
              </td>
            </ng-container>

            <!-- Tri -->
            <ng-container matColumnDef="ordering">
              <th mat-header-cell *matHeaderCellDef>Tri</th>
              <td mat-cell *matCellDef="let row">{{ row.ordering }}</td>
            </ng-container>

            <!-- Grouper -->
            <ng-container matColumnDef="groupby">
              <th mat-header-cell *matHeaderCellDef>Grouper</th>
              <td mat-cell *matCellDef="let row">{{ row.groupBy }}</td>
            </ng-container>

            <!-- Modifier -->
            <ng-container matColumnDef="edit">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let row">
                <button
                  mat-raised-button
                  color="primary"
                  (click)="onEditSelectRowButtonClicked(row.key)"
                >
                  Modifier
                </button>
              </td>
            </ng-container>

            <!-- Supprimer -->
            <ng-container matColumnDef="delete">
              <th mat-header-cell *matHeaderCellDef></th>
              <td mat-cell *matCellDef="let row">
                <button
                  mat-raised-button
                  color="primary"
                  (click)="onDeleteSelectRowButtonClicked(row)"
                >
                  Supprimer
                </button>
              </td>
            </ng-container>

            <!-- Lines -->
            <tr
              mat-header-row
              *matHeaderRowDef="selectTableDisplayedColumns"
            ></tr>
            <tr
              mat-row
              *matRowDef="let row; columns: selectTableDisplayedColumns"
            ></tr>
          </table>
        </div>
      </div>

      <div>
        <button
          mat-raised-button
          color="primary"
          (click)="onAddWhereButtonClicked()"
        >
          Filtrer
        </button>
        <div>
          <div>
            <table mat-table [dataSource]="whereTableDataSource">
              <
              <!-- Up/down buttons -->
              <ng-container matColumnDef="updown">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="onUpWhereRowButtonClicked(row)"
                  >
                    Monter
                  </button>
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="onDownWhereRowButtonClicked(row)"
                  >
                    Descendre
                  </button>
                </td>
              </ng-container>

              <!-- Colonne -->
              <ng-container matColumnDef="column">
                <th mat-header-cell *matHeaderCellDef>Colonne</th>
                <td mat-cell *matCellDef="let row">
                  {{ columns[row.key].displayName }}
                </td>
              </ng-container>

              <!-- Modifier -->
              <ng-container matColumnDef="edit">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="onEditWhereRowButtonClicked(row.key)"
                  >
                    Modifier
                  </button>
                </td>
              </ng-container>

              <!-- Supprimer -->
              <ng-container matColumnDef="delete">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let row">
                  <button
                    mat-raised-button
                    color="primary"
                    (click)="onRemoveWhereRowButtonClicked(row)"
                  >
                    Supprimer
                  </button>
                </td>
              </ng-container>

              <!-- Lines -->
              <tr
                mat-header-row
                *matHeaderRowDef="whereTableDisplayedColumns"
              ></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: whereTableDisplayedColumns"
              ></tr>
            </table>
          </div>
          <div>
            <button
              mat-raised-button
              color="primary"
              (click)="onAddLogicalOperatorButtonClicked('and')"
            >
              ET
            </button>
            <button
              mat-raised-button
              color="primary"
              (click)="onAddLogicalOperatorButtonClicked('or')"
            >
              OU
            </button>
            <button
              mat-raised-button
              color="primary"
              (click)="onAddLogicalOperatorButtonClicked('openingParenthesis')"
            >
              (
            </button>
            <button
              mat-raised-button
              color="primary"
              (click)="onAddLogicalOperatorButtonClicked('closingParenthesis')"
            >
              )
            </button>
          </div>
        </div>
      </div>
      <div>
        <button
          mat-raised-button
          color="primary"
          (click)="onSaveQueryButtonClicked()"
        >
          Sauvegarder la requête
        </button>
        <button
          mat-raised-button
          color="primary"
          (click)="onSearchButtonClicked()"
        >
          Lancer la recherche
        </button>
      </div>
    </div>
  </div>
</div>

<div>
  <table mat-table [dataSource]="dataSource" matSort class="bn-table-view">
    <ng-container matColumnDef="id">
      <th
        mat-header-cell
        *matHeaderCellDef
        mat-sort-header
        class="bn-table-view-id"
      >
        ID
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-id">
        {{ element.id }}
      </td>
    </ng-container>

    <ng-container matColumnDef="observateur">
      <th
        mat-header-cell
        mat-sort-header
        *matHeaderCellDef
        class="bn-table-view-observateur"
      >
        Observateur
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-observateur">
        {{ element.observateur }}
      </td>
    </ng-container>

    <ng-container matColumnDef="associes">
      <th
        mat-header-cell
        mat-sort-header
        *matHeaderCellDef
        class="bn-table-view-associes"
      >
        Observateurs associés
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-associes">
        {{ element.associes }}
      </td>
    </ng-container>

    <ng-container matColumnDef="date">
      <th
        mat-header-cell
        mat-sort-header
        *matHeaderCellDef
        class="bn-table-view-date"
      >
        Date
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-date">
        {{ element.date }}
      </td>
    </ng-container>

    <ng-container matColumnDef="heure">
      <th
        mat-header-cell
        mat-sort-header
        *matHeaderCellDef
        class="bn-table-view-heure"
      >
        Heure
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-heure">
        {{ element.heure }}
      </td>
    </ng-container>

    <ng-container matColumnDef="duree">
      <th
        mat-header-cell
        mat-sort-header
        *matHeaderCellDef
        class="bn-table-view-duree"
      >
        Durée
      </th>
      <td mat-cell *matCellDef="let element" class="bn-table-view-duree">
        {{ element.duree }}
      </td>
    </ng-container>

    <ng-container matColumnDef="departement">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Département
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.departement }}
      </td>
    </ng-container>

    <ng-container matColumnDef="code_commune">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Code commune
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.codeCommune }}
      </td>
    </ng-container>

    <ng-container matColumnDef="nom_commune">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Nom commune
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.nomCommune }}
      </td>
    </ng-container>

    <ng-container matColumnDef="lieudit">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Lieu-dit
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.lieudit }}
      </td>
    </ng-container>

    <ng-container matColumnDef="altitude">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Altitude
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.altitude }}
      </td>
    </ng-container>

    <ng-container matColumnDef="longitude">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Longitude
      </th>
      <td mat-cell *matCellDef="let element">
        {{
          !!element.customizedLongitude
            ? element.customizedLongitude
            : element.longitude
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="latitude">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Latitude
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.latitude }}
      </td>
    </ng-container>

    <ng-container matColumnDef="temperature">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Température
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.temperature }}
      </td>
    </ng-container>

    <ng-container matColumnDef="meteos">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Météos
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.meteos }}
      </td>
    </ng-container>

    <ng-container matColumnDef="classe">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Classe espèce
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.classe }}
      </td>
    </ng-container>

    <ng-container matColumnDef="code_espece">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Code espèce
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.codeEspece }}
      </td>
    </ng-container>

    <ng-container matColumnDef="nom_francais">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Nom français
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.nomFrancais }}
      </td>
    </ng-container>

    <ng-container matColumnDef="nom_latin">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Nom latin
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.nomLatin }}
      </td>
    </ng-container>

    <ng-container matColumnDef="nombre">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Nombre
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.nombre }}
      </td>
    </ng-container>

    <ng-container matColumnDef="estimation_nombre">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Estimation du nombre
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.estimationNombre }}
      </td>
    </ng-container>

    <ng-container matColumnDef="sexe">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Sexe
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.sexe }}
      </td>
    </ng-container>

    <ng-container matColumnDef="age">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Âge
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.age }}
      </td>
    </ng-container>

    <ng-container matColumnDef="estimation_distance">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Estimation de la distance
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.estimationDistance }}
      </td>
    </ng-container>

    <ng-container matColumnDef="distance">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Distance (m)
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.distance }}
      </td>
    </ng-container>

    <ng-container matColumnDef="regroupement">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Regroupement
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.regroupement }}
      </td>
    </ng-container>

    <ng-container matColumnDef="code_comportement_1">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Code comportement 1
      </th>
      <td mat-cell *matCellDef="let element">
        {{
          element.comportements.length >= 1 ? element.comportements[0].code : ""
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="libelle_comportement_1">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Libellé comportement 1
      </th>
      <td mat-cell *matCellDef="let element">
        {{
          element.comportements.length >= 1
            ? element.comportements[0].libelle
            : ""
        }}
      </td>
    </ng-container>

    <ng-container matColumnDef="commentaire">
      <th mat-header-cell mat-sort-header *matHeaderCellDef>
        Commentaires
      </th>
      <td mat-cell *matCellDef="let element">
        {{ element.commentaire }}
      </td>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

    <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>
  </table>

  <mat-paginator [pageSizeOptions]="[1000, 2500, 5000]"></mat-paginator>
</div>
