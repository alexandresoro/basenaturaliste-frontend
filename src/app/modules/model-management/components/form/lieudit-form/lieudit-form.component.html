<!-- Departement -->
<mat-form-field>
  <mat-select
    [formControl]="departementControl"
    id="input-departement"
    name="departement"
    placeholder="Département"
  >
    <mat-option
      *ngFor="let departement of departements$ | async"
      [value]="departement"
    >
      {{ departement.code }}
    </mat-option>
  </mat-select>
  <mat-error *ngIf="departementControl.hasError('required')">
    Le champ "Département" ne peut pas être vide.
  </mat-error>
</mat-form-field>

<!-- Code Commune -->
<mat-form-field>
  <mat-select
    [formControl]="entityForm.controls['communeId']"
    id="input-code-commune"
    name="code-commune"
    placeholder="Code de la commune"
  >
    <mat-option
      *ngFor="let commune of filteredCommunes$ | async"
      [value]="commune.id"
    >
      {{ commune.code }}
    </mat-option>
  </mat-select>
  <mat-error *ngIf="entityForm.controls['communeId'].hasError('required')">
    Le champ "Code de la commune" ne peut pas être vide.
  </mat-error>
</mat-form-field>

<!-- Nom Commune -->
<mat-form-field>
  <mat-select
    [formControl]="nomCommuneControl"
    id="input-nom-commune"
    name="nom-commune"
    placeholder="Nom de la commune"
  >
    <mat-option
      *ngFor="let commune of filteredCommunes$ | async"
      [value]="commune.id"
    >
      {{ commune.nom }}
    </mat-option>
  </mat-select>
  <mat-error *ngIf="nomCommuneControl.hasError('required')">
    Le champ "Nom de la commune" ne peut pas être vide.
  </mat-error>
</mat-form-field>

<!-- Nom lieudit -->
<mat-form-field>
  <input
    [errorStateMatcher]="lieuditNomErrorStateMatcher"
    [formControl]="entityForm.controls['nom']"
    id="input-nom"
    matInput
    maxlength="150"
    name="nom"
    placeholder="Nom du lieu-dit"
    type="text"
  />

  <mat-error *ngIf="entityForm.controls['nom'].hasError('required')">
    Le champ "Nom du lieu-dit" ne peut pas être vide.
  </mat-error>
  <mat-error *ngIf="entityForm.hasError('alreadyExistingNom')">
    {{ entityForm.getError("alreadyExistingNom").message }}
  </mat-error>
</mat-form-field>

<!-- Altitude -->
<mat-form-field>
  <input
    [formControl]="entityForm.controls['altitude']"
    id="input-altitude"
    matInput
    min="0"
    max="65535"
    name="altitude"
    placeholder="Altitude en mètres"
    type="number"
  />

  <mat-error *ngIf="entityForm.controls['altitude'].hasError('required')">
    Le champ "Altitude" ne peut pas être vide.
  </mat-error>
  <mat-error *ngIf="entityForm.controls['altitude'].hasError('forbiddenValue')">
    L'altitude doit être un entier compris entre 0 et 65535.
  </mat-error>
</mat-form-field>

<!-- Longitude -->
<mat-form-field>
  <input
    [formControl]="entityForm.controls['longitude']"
    id="input-longitude"
    matInput
    min="{{ (coordinatesSystem$ | async)?.longitudeRange.min }}"
    max="{{ (coordinatesSystem$ | async)?.longitudeRange.max }}"
    name="longitude"
    placeholder="Longitude en {{ (coordinatesSystem$ | async)?.unitName }}"
    type="number"
  />

  <mat-error *ngIf="entityForm.controls['longitude'].hasError('required')">
    Le champ "Longitude" ne peut pas être vide.
  </mat-error>
  <mat-error
    *ngIf="
      entityForm.controls['longitude'].hasError('min') ||
      entityForm.controls['longitude'].hasError('max')
    "
  >
    La longitude doit être un nombre compris entre
    {{ (coordinatesSystem$ | async)?.longitudeRange.min }} et
    {{ (coordinatesSystem$ | async)?.longitudeRange.max }}.
  </mat-error>
</mat-form-field>

<!-- Latitude -->
<mat-form-field>
  <input
    [formControl]="entityForm.controls['latitude']"
    id="input-latitude"
    matInput
    min="{{ (coordinatesSystem$ | async)?.latitudeRange.min }}"
    max="{{ (coordinatesSystem$ | async)?.latitudeRange.max }}"
    name="latitude"
    placeholder="Latitude en {{ (coordinatesSystem$ | async)?.unitName }}"
    type="number"
  />

  <mat-error *ngIf="entityForm.controls['latitude'].hasError('required')">
    Le champ "Latitude" ne peut pas être vide.
  </mat-error>
  <mat-error
    *ngIf="
      entityForm.controls['latitude'].hasError('min') ||
      entityForm.controls['latitude'].hasError('max')
    "
  >
    La latitude doit être un nombre compris entre
    {{ (coordinatesSystem$ | async)?.latitudeRange.min }} et
    {{ (coordinatesSystem$ | async)?.latitudeRange.max }}.
  </mat-error>
</mat-form-field>

<p
  *ngIf="(currentCoordinates$ | async).isTransformed"
  class="coordinates-warning"
>
  Attention: les coordonnées de ce lieu-dit ont été converties à partir d'un
  autre système de coordonnées.
</p>
