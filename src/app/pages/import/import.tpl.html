<h1>Import de données</h1>

<ng-container *ngIf="isWaitPanelDisplayed">
  <h2>
    <mat-icon>loop</mat-icon> Veuillez patienter pendant l'import...</h2>
</ng-container>

<ng-container *ngIf="!isWaitPanelDisplayed">
  <h2>Tutoriel d'import</h2>
  <h3>Préparation du fichier d'entrée</h3>
  <p>Copiez les données à importer dans un tableur excel en respectant le format indiqué pour chaque type
    de données.</p>
  <p>Cliquez sur "Enregistrez-sous", choisir le type de fichier "CSV (séparateur point-virgule)". Enregistrez.</p>
  <p>Ouvrez le fichier avec un éditeur de texte (Notepad) et vérifiez que vous avez respectez les points
    suivants:
  </p>
  <ul>
    <li>Le fichier d'entrée ne doit pas contenir d'en-tête.</li>
    <li>Les colonnes sont séparées par des points-virgule (;).</li>
    <li>L'ordre des colonnes est important.</li>
    <li>Il y a une seule ligne vide à la fin du fichier.</li>
  </ul>


  <h3>Import</h3>
  <p>Plus bas dans la page, choisissez le type de données que vous souhaitez importer.</p>
  <p>Cliquer sur le bouton d'import.</p>
  <p>Choisissez le fichier d'entrée que vous venez de préparer.</p>
  <p>L'import se lance.</p>

  <h3>Résultats de l'import</h3>
  <p>L'application va lire chaque ligne du fichier d'entrée et tenter d'importer cette ligne dans la base
    de données.</p>
  <p>Toutes les lignes qui n'ont pas pu être importées sont enregistrées dans un fichier de sortie situé
    dans le même dossier que le fichier d'entrée.</p>



  <mat-accordion>
    <!-- OBSERVATEURS -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Observateurs</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: nom des observateurs</li>
      </ul>

      <input type=file
        id="input-observateur"
        name="observateur"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('observateur')">
        Lancer l'import des observateurs
      </button>
    </mat-expansion-panel>


    <!-- DEPARTEMENTS -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Départements</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Département</li>
      </ul>

      <input type=file
        id="input-departement"
        name="departement"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('departement')">
        Lancer l'import des départements
      </button>
    </mat-expansion-panel>


    <!-- COMMUNE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Communes</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Département</li>
        <li>Colonne B: Code de la communne</li>
        <li>Colonne C: Nom de la commune</li>
      </ul>

      <input type=file
        id="input-commune"
        name="commune"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('commune')">
        Lancer l'import des communes
      </button>
    </mat-expansion-panel>


    <!-- LIEUDIT -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Lieux-dits</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Les départements et communes manquants seront automatiquement créés.</p>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Département</li>
        <li>Colonne B: Code de la communne</li>
        <li>Colonne C: Nom de la commune</li>
        <li>Colonne D: Lieu-dit</li>
        <li>Colonne E: Altitude (nombre entier)</li>
        <li>Colonne F: Longitude (nombre entier)</li>
        <li>Colonne G: Latitude (nombre entier)</li>
      </ul>

      <input type=file
        id="input-lieudit"
        name="lieudit"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('lieudit')">
        Lancer l'import des lieux-dits
      </button>
    </mat-expansion-panel>

    <!-- METEO -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Météos</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de la météo</li>
      </ul>

      <input type=file
        id="input-meteo"
        name="meteo"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('meteo')">
        Lancer l'import des météos
      </button>
    </mat-expansion-panel>

    <!-- CLASSE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Classes espèces</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de la classe espèce</li>
      </ul>

      <input type=file
        id="input-classe"
        name="classe"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('classe')">
        Lancer l'import des classes espèces
      </button>
    </mat-expansion-panel>

    <!-- ESPECE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Espèces</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de la classe espèce</li>
        <li>Colonne B: Code de l'espèce</li>
        <li>Colonne C: Nom français de l'espèce</li>
        <li>Colonne D: Nom latin de l'espèce</li>
      </ul>

      <input type=file
        id="input-espece"
        name="espece"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('espece')">
        Lancer l'import des espèces
      </button>
    </mat-expansion-panel>

    <!-- SEXE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Sexes</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé du sexe</li>
      </ul>

      <input type=file
        id="input-sexe"
        name="sexe"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('sexe')">
        Lancer l'import des sexes
      </button>
    </mat-expansion-panel>


    <!-- AGE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Âges</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de l'âge</li>
      </ul>

      <input type=file
        id="input-age"
        name="age"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('age')">
        Lancer l'import des âges
      </button>
    </mat-expansion-panel>


    <!-- ESTIMATION NOMBRE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Estimations du nombre</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Après l'import rendez vous sur la page de modification des estimations du nombre pour régler l'option
        "Non compté"</p>
      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de l'estimation du nombre</li>
      </ul>

      <input type=file
        id="input-estimation-nombre"
        name="estimation-nombre"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('estimation-nombre')">
        Lancer l'import des estimations du nombre
      </button>
    </mat-expansion-panel>


    <!-- ESTIMATION DISTANCE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Estimations de la distance</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Libellé de l'estimation de la distance</li>
      </ul>

      <input type=file
        id="input-estimation-distance"
        name="estimation-distance"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('estimation-distance')">
        Lancer l'import des estimations de la distance
      </button>
    </mat-expansion-panel>

    <!-- COMPORTEMENT -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Comportements</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Code du comportement</li>
        <li>Colonne B: Libellé du comportement</li>
      </ul>

      <input type=file
        id="input-comportement"
        name="comportement"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('comportement')">
        Lancer l'import des comportements
      </button>
    </mat-expansion-panel>


    <!-- MILIEUX -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Milieux</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Code du milieu</li>
        <li>Colonne B: Libellé du milieu</li>
      </ul>

      <input type=file
        id="input-milieu"
        name="milieu"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('milieu')">
        Lancer l'import des milieux
      </button>
    </mat-expansion-panel>


    <!-- DONNEE -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>
          <h2>Importer des Données</h2>
        </mat-panel-title>
      </mat-expansion-panel-header>

      <p>Liste des colonnes:</p>
      <ul>
        <li>Colonne A: Code de l'espèce</li>
        <li>Colonne B: Estimation du nombre</li>
        <li>Colonne C: Nombre (nombre entier ou vide)</li>
        <li>Colonne D: Sexe</li>
        <li>Colonne E: Âge</li>
        <li>Colonne F: Code comportement 1</li>
        <li>Colonne G: Code comportement 2</li>
        <li>Colonne H: Code comportement 3</li>
        <li>Colonne I: Code comportement 4</li>
        <li>Colonne J: Code comportement 5</li>
        <li>Colonne K: Code comportement 6</li>
        <li>Colonne L: Code milieu 1</li>
        <li>Colonne M: Code milieu 2</li>
        <li>Colonne N: Code milieu 3</li>
        <li>Colonne O: Code milieu 4</li>
        <li>Colonne P: Date (JJ/MM/AAAA)</li>
        <li>Colonne Q: Heure (HH:MM ou HHhMM or HHHMM)</li>
        <li>Colonne R: Durée (HH:MM ou HHhMM or HHHMM)</li>
        <li>Colonne S: Observateur</li>
        <li>Colonne T: Commentaire</li>
        <li>Colonne U: Département</li>
        <li>Colonne V: Code commune</li>
        <li>Colonne W: Lieu-dit</li>
        <li>Colonne X: Altitude (nombre entier)</li>
        <li>Colonne Y: Longitude (nombre entier)</li>
        <li>Colonne Z: Latitude (nombre entier)</li>
        <li>Colonne AA: Estimation distance</li>
        <li>Colonne AB: Distance (nombre entier)</li>
        <li>Colonne AC: Température</li>
        <li>Colonne AD: Météos (liste séparée par des virgules)</li>
        <li>Colonne AE: Observateurs associés (liste séparée par des virgules)</li>
        <li>Colonne AF: Numéro de regroupement</li>
      </ul>

      <input type=file
        id="input-donnee"
        name="donnee"
        (change)="setFile($event)">

      <button mat-raised-button
        color="primary"
        (click)="onImportClicked('donnee')">
        Lancer l'import des données
      </button>
    </mat-expansion-panel>
  </mat-accordion>
</ng-container>